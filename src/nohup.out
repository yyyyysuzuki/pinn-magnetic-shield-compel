/home/ysuzuki/miniconda3/envs/pytorch_gpu/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /opt/conda/conda-bld/pytorch_1729647352509/work/aten/src/ATen/cuda/CublasHandlePool.cpp:135.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/ysuzuki/pinn_workplace/pinn-magnetic-shield-compel/src/pinn.py:249: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig = plt.figure(figsize=(7,6), dpi=150)
[info] interior N=20000, Dirichlet Nb=86, Neumann Nb=32, device=cuda
[    1] loss=9.537e+09 | pde=9.537e+09 dir=3.396e-02 neu=4.136e+10
[OK] saved -> 1_pinn_model.pt
1_saved A_grid_contourf.png
[  200] loss=1.068e+10 | pde=1.068e+10 dir=1.240e-04 neu=2.307e+06
[OK] saved -> 200_pinn_model.pt
200_saved A_grid_contourf.png
[  400] loss=8.672e+09 | pde=8.666e+09 dir=3.203e+01 neu=3.103e+11
[OK] saved -> 400_pinn_model.pt
400_saved A_grid_contourf.png
[  600] loss=7.759e+09 | pde=7.747e+09 dir=5.273e+01 neu=6.513e+11
[OK] saved -> 600_pinn_model.pt
600_saved A_grid_contourf.png
[  800] loss=7.280e+09 | pde=7.227e+09 dir=8.866e+01 neu=4.458e+12
[OK] saved -> 800_pinn_model.pt
800_saved A_grid_contourf.png
[ 1000] loss=8.998e+09 | pde=8.961e+09 dir=6.767e+01 neu=3.012e+12
[OK] saved -> 1000_pinn_model.pt
1000_saved A_grid_contourf.png
[ 1200] loss=6.977e+09 | pde=6.924e+09 dir=1.704e+02 neu=3.628e+12
[OK] saved -> 1200_pinn_model.pt
1200_saved A_grid_contourf.png
[ 1400] loss=1.159e+10 | pde=1.154e+10 dir=1.494e+02 neu=3.204e+12
[OK] saved -> 1400_pinn_model.pt
1400_saved A_grid_contourf.png
[ 1600] loss=6.292e+09 | pde=6.238e+09 dir=3.750e+02 neu=1.727e+12
[OK] saved -> 1600_pinn_model.pt
1600_saved A_grid_contourf.png
[ 1800] loss=7.036e+09 | pde=7.000e+09 dir=2.620e+02 neu=8.907e+11
[OK] saved -> 1800_pinn_model.pt
1800_saved A_grid_contourf.png
[ 2000] loss=6.840e+09 | pde=6.784e+09 dir=2.522e+02 neu=3.080e+12
[OK] saved -> 2000_pinn_model.pt
2000_saved A_grid_contourf.png
[ 2200] loss=7.905e+09 | pde=7.862e+09 dir=3.178e+02 neu=1.125e+12
[OK] saved -> 2200_pinn_model.pt
2200_saved A_grid_contourf.png
[ 2400] loss=6.796e+09 | pde=6.745e+09 dir=2.048e+02 neu=3.034e+12
[OK] saved -> 2400_pinn_model.pt
2400_saved A_grid_contourf.png
[ 2600] loss=6.028e+09 | pde=5.981e+09 dir=4.490e+02 neu=2.204e+11
[OK] saved -> 2600_pinn_model.pt
2600_saved A_grid_contourf.png
[ 2800] loss=8.468e+09 | pde=8.296e+09 dir=1.668e+03 neu=5.312e+11
[OK] saved -> 2800_pinn_model.pt
2800_saved A_grid_contourf.png
[ 3000] loss=1.036e+10 | pde=1.025e+10 dir=1.111e+03 neu=3.446e+11
[OK] saved -> 3000_pinn_model.pt
3000_saved A_grid_contourf.png
[ 3200] loss=6.159e+09 | pde=6.071e+09 dir=8.769e+02 neu=9.946e+10
[OK] saved -> 3200_pinn_model.pt
3200_saved A_grid_contourf.png
[ 3400] loss=9.123e+09 | pde=9.036e+09 dir=8.584e+02 neu=8.608e+10
[OK] saved -> 3400_pinn_model.pt
3400_saved A_grid_contourf.png
[ 3600] loss=8.829e+09 | pde=8.742e+09 dir=8.622e+02 neu=4.760e+10
[OK] saved -> 3600_pinn_model.pt
3600_saved A_grid_contourf.png
[ 3800] loss=9.137e+09 | pde=9.063e+09 dir=7.383e+02 neu=3.676e+10
[OK] saved -> 3800_pinn_model.pt
3800_saved A_grid_contourf.png
[ 4000] loss=1.142e+10 | pde=1.136e+10 dir=5.866e+02 neu=7.246e+10
[OK] saved -> 4000_pinn_model.pt
4000_saved A_grid_contourf.png
[ 4200] loss=9.854e+09 | pde=9.796e+09 dir=5.697e+02 neu=5.193e+10
[OK] saved -> 4200_pinn_model.pt
4200_saved A_grid_contourf.png
[ 4400] loss=8.043e+09 | pde=7.991e+09 dir=5.095e+02 neu=8.474e+10
[OK] saved -> 4400_pinn_model.pt
4400_saved A_grid_contourf.png
[ 4600] loss=8.161e+09 | pde=8.108e+09 dir=4.975e+02 neu=3.928e+11
[OK] saved -> 4600_pinn_model.pt
4600_saved A_grid_contourf.png
[ 4800] loss=7.488e+09 | pde=7.457e+09 dir=3.132e+02 neu=1.774e+10
[OK] saved -> 4800_pinn_model.pt
4800_saved A_grid_contourf.png
[ 5000] loss=1.228e+10 | pde=1.223e+10 dir=4.307e+02 neu=4.804e+11
[OK] saved -> 5000_pinn_model.pt
5000_saved A_grid_contourf.png
[ 5200] loss=6.792e+09 | pde=6.760e+09 dir=3.134e+02 neu=2.371e+10
[OK] saved -> 5200_pinn_model.pt
5200_saved A_grid_contourf.png
[ 5400] loss=9.759e+09 | pde=9.732e+09 dir=2.704e+02 neu=4.107e+10
[OK] saved -> 5400_pinn_model.pt
5400_saved A_grid_contourf.png
[ 5600] loss=8.147e+09 | pde=8.128e+09 dir=1.898e+02 neu=1.161e+10
[OK] saved -> 5600_pinn_model.pt
5600_saved A_grid_contourf.png
[ 5800] loss=9.419e+09 | pde=9.391e+09 dir=2.748e+02 neu=4.401e+10
[OK] saved -> 5800_pinn_model.pt
5800_saved A_grid_contourf.png
[ 6000] loss=7.332e+09 | pde=7.309e+09 dir=2.331e+02 neu=5.305e+10
[OK] saved -> 6000_pinn_model.pt
6000_saved A_grid_contourf.png
[ 6200] loss=5.758e+09 | pde=5.737e+09 dir=1.621e+02 neu=4.911e+11
[OK] saved -> 6200_pinn_model.pt
6200_saved A_grid_contourf.png
[ 6400] loss=7.323e+09 | pde=7.302e+09 dir=1.917e+02 neu=1.319e+11
[OK] saved -> 6400_pinn_model.pt
6400_saved A_grid_contourf.png
[ 6600] loss=6.914e+09 | pde=6.888e+09 dir=2.518e+02 neu=1.162e+11
[OK] saved -> 6600_pinn_model.pt
6600_saved A_grid_contourf.png
[ 6800] loss=6.324e+09 | pde=6.306e+09 dir=1.765e+02 neu=3.051e+10
[OK] saved -> 6800_pinn_model.pt
6800_saved A_grid_contourf.png
[ 7000] loss=8.647e+09 | pde=8.626e+09 dir=1.832e+02 neu=2.782e+11
[OK] saved -> 7000_pinn_model.pt
7000_saved A_grid_contourf.png
[ 7200] loss=6.572e+09 | pde=6.555e+09 dir=1.429e+02 neu=1.938e+11
[OK] saved -> 7200_pinn_model.pt
7200_saved A_grid_contourf.png
[ 7400] loss=6.318e+09 | pde=6.294e+09 dir=2.408e+02 neu=6.179e+09
[OK] saved -> 7400_pinn_model.pt
7400_saved A_grid_contourf.png
[ 7600] loss=7.263e+09 | pde=7.253e+09 dir=8.858e+01 neu=1.335e+11
[OK] saved -> 7600_pinn_model.pt
7600_saved A_grid_contourf.png
[ 7800] loss=7.696e+09 | pde=7.657e+09 dir=3.473e+02 neu=4.041e+11
[OK] saved -> 7800_pinn_model.pt
7800_saved A_grid_contourf.png
[ 8000] loss=7.011e+09 | pde=6.985e+09 dir=2.509e+02 neu=2.518e+10
[OK] saved -> 8000_pinn_model.pt
8000_saved A_grid_contourf.png
[ 8200] loss=7.487e+09 | pde=7.456e+09 dir=3.079e+02 neu=6.105e+10
[OK] saved -> 8200_pinn_model.pt
8200_saved A_grid_contourf.png
[ 8400] loss=5.679e+09 | pde=5.653e+09 dir=2.622e+02 neu=3.659e+10
[OK] saved -> 8400_pinn_model.pt
8400_saved A_grid_contourf.png
[ 8600] loss=5.516e+09 | pde=5.492e+09 dir=2.241e+02 neu=1.757e+11
[OK] saved -> 8600_pinn_model.pt
8600_saved A_grid_contourf.png
[ 8800] loss=4.434e+09 | pde=4.379e+09 dir=5.493e+02 neu=2.847e+10
[OK] saved -> 8800_pinn_model.pt
8800_saved A_grid_contourf.png
[ 9000] loss=4.878e+09 | pde=4.825e+09 dir=5.301e+02 neu=1.789e+10
[OK] saved -> 9000_pinn_model.pt
9000_saved A_grid_contourf.png
[ 9200] loss=5.682e+09 | pde=5.652e+09 dir=2.953e+02 neu=1.282e+10
[OK] saved -> 9200_pinn_model.pt
9200_saved A_grid_contourf.png
[ 9400] loss=5.048e+09 | pde=4.982e+09 dir=6.490e+02 neu=1.014e+11
[OK] saved -> 9400_pinn_model.pt
9400_saved A_grid_contourf.png
[ 9600] loss=4.428e+09 | pde=4.371e+09 dir=5.673e+02 neu=1.572e+10
[OK] saved -> 9600_pinn_model.pt
9600_saved A_grid_contourf.png
[ 9800] loss=4.613e+09 | pde=4.580e+09 dir=3.286e+02 neu=4.990e+09
[OK] saved -> 9800_pinn_model.pt
9800_saved A_grid_contourf.png
[10000] loss=6.152e+09 | pde=6.111e+09 dir=4.082e+02 neu=8.689e+09
[OK] saved -> 10000_pinn_model.pt
10000_saved A_grid_contourf.png
[10200] loss=6.092e+09 | pde=6.041e+09 dir=4.964e+02 neu=1.310e+11
[OK] saved -> 10200_pinn_model.pt
10200_saved A_grid_contourf.png
[10400] loss=4.070e+09 | pde=4.038e+09 dir=3.130e+02 neu=4.424e+10
[OK] saved -> 10400_pinn_model.pt
10400_saved A_grid_contourf.png
[10600] loss=5.825e+09 | pde=5.799e+09 dir=2.585e+02 neu=3.794e+10
[OK] saved -> 10600_pinn_model.pt
10600_saved A_grid_contourf.png
[10800] loss=4.541e+09 | pde=4.502e+09 dir=3.904e+02 neu=2.276e+10
[OK] saved -> 10800_pinn_model.pt
10800_saved A_grid_contourf.png
[11000] loss=7.455e+09 | pde=7.388e+09 dir=6.205e+02 neu=4.194e+11
[OK] saved -> 11000_pinn_model.pt
11000_saved A_grid_contourf.png
[11200] loss=9.307e+09 | pde=9.287e+09 dir=1.793e+02 neu=2.283e+11
[OK] saved -> 11200_pinn_model.pt
11200_saved A_grid_contourf.png
[11400] loss=3.267e+09 | pde=3.219e+09 dir=4.647e+02 neu=1.425e+11
[OK] saved -> 11400_pinn_model.pt
11400_saved A_grid_contourf.png
[11600] loss=4.003e+09 | pde=3.859e+09 dir=1.439e+03 neu=3.798e+10
[OK] saved -> 11600_pinn_model.pt
11600_saved A_grid_contourf.png
[11800] loss=7.132e+09 | pde=7.112e+09 dir=1.851e+02 neu=1.203e+11
[OK] saved -> 11800_pinn_model.pt
11800_saved A_grid_contourf.png
[12000] loss=6.731e+09 | pde=6.724e+09 dir=6.956e+01 neu=5.101e+10
[OK] saved -> 12000_pinn_model.pt
12000_saved A_grid_contourf.png
[12200] loss=3.653e+09 | pde=3.542e+09 dir=1.101e+03 neu=4.072e+09
[OK] saved -> 12200_pinn_model.pt
12200_saved A_grid_contourf.png
[12400] loss=2.544e+09 | pde=2.496e+09 dir=4.775e+02 neu=8.403e+09
[OK] saved -> 12400_pinn_model.pt
12400_saved A_grid_contourf.png
[12600] loss=6.162e+09 | pde=6.151e+09 dir=9.287e+01 neu=1.754e+11
[OK] saved -> 12600_pinn_model.pt
12600_saved A_grid_contourf.png
[12800] loss=3.507e+09 | pde=3.452e+09 dir=5.466e+02 neu=4.757e+10
[OK] saved -> 12800_pinn_model.pt
12800_saved A_grid_contourf.png
[13000] loss=3.000e+09 | pde=2.785e+09 dir=2.148e+03 neu=6.412e+10
[OK] saved -> 13000_pinn_model.pt
13000_saved A_grid_contourf.png
[13200] loss=5.033e+09 | pde=5.011e+09 dir=2.222e+02 neu=5.551e+10
[OK] saved -> 13200_pinn_model.pt
13200_saved A_grid_contourf.png
[13400] loss=3.022e+09 | pde=2.977e+09 dir=4.525e+02 neu=5.515e+09
[OK] saved -> 13400_pinn_model.pt
13400_saved A_grid_contourf.png
[13600] loss=6.695e+09 | pde=6.613e+09 dir=7.891e+02 neu=2.254e+11
[OK] saved -> 13600_pinn_model.pt
13600_saved A_grid_contourf.png
[13800] loss=5.366e+09 | pde=5.287e+09 dir=7.890e+02 neu=6.310e+10
[OK] saved -> 13800_pinn_model.pt
13800_saved A_grid_contourf.png
[14000] loss=3.383e+09 | pde=3.266e+09 dir=1.156e+03 neu=1.377e+11
[OK] saved -> 14000_pinn_model.pt
14000_saved A_grid_contourf.png
[14200] loss=3.335e+09 | pde=3.301e+09 dir=3.259e+02 neu=8.266e+10
[OK] saved -> 14200_pinn_model.pt
14200_saved A_grid_contourf.png
[14400] loss=3.896e+09 | pde=3.811e+09 dir=8.194e+02 neu=2.878e+11
[OK] saved -> 14400_pinn_model.pt
14400_saved A_grid_contourf.png
[14600] loss=5.387e+09 | pde=5.269e+09 dir=1.164e+03 neu=1.084e+11
[OK] saved -> 14600_pinn_model.pt
14600_saved A_grid_contourf.png
[14800] loss=1.947e+09 | pde=1.935e+09 dir=1.186e+02 neu=3.375e+10
[OK] saved -> 14800_pinn_model.pt
14800_saved A_grid_contourf.png
[15000] loss=3.731e+09 | pde=3.703e+09 dir=2.699e+02 neu=3.338e+10
[OK] saved -> 15000_pinn_model.pt
15000_saved A_grid_contourf.png
[15200] loss=4.237e+09 | pde=4.215e+09 dir=2.167e+02 neu=5.835e+10
[OK] saved -> 15200_pinn_model.pt
15200_saved A_grid_contourf.png
[15400] loss=2.875e+09 | pde=2.838e+09 dir=3.666e+02 neu=7.664e+10
[OK] saved -> 15400_pinn_model.pt
15400_saved A_grid_contourf.png
[15600] loss=4.233e+09 | pde=4.168e+09 dir=6.355e+02 neu=1.648e+11
[OK] saved -> 15600_pinn_model.pt
15600_saved A_grid_contourf.png
[15800] loss=3.608e+09 | pde=3.601e+09 dir=5.927e+01 neu=6.446e+10
[OK] saved -> 15800_pinn_model.pt
15800_saved A_grid_contourf.png
[16000] loss=4.080e+09 | pde=4.044e+09 dir=3.519e+02 neu=9.060e+10
[OK] saved -> 16000_pinn_model.pt
16000_saved A_grid_contourf.png
[16200] loss=2.477e+09 | pde=2.469e+09 dir=7.401e+01 neu=1.014e+11
[OK] saved -> 16200_pinn_model.pt
16200_saved A_grid_contourf.png
[16400] loss=4.533e+09 | pde=4.509e+09 dir=2.302e+02 neu=9.461e+10
[OK] saved -> 16400_pinn_model.pt
16400_saved A_grid_contourf.png
[16600] loss=2.218e+09 | pde=2.197e+09 dir=1.895e+02 neu=2.379e+11
[OK] saved -> 16600_pinn_model.pt
16600_saved A_grid_contourf.png
[16800] loss=2.886e+09 | pde=2.866e+09 dir=1.880e+02 neu=1.457e+11
[OK] saved -> 16800_pinn_model.pt
16800_saved A_grid_contourf.png
[17000] loss=3.263e+09 | pde=3.246e+09 dir=1.343e+02 neu=3.414e+11
[OK] saved -> 17000_pinn_model.pt
17000_saved A_grid_contourf.png
[17200] loss=6.975e+09 | pde=6.919e+09 dir=5.378e+02 neu=1.995e+11
[OK] saved -> 17200_pinn_model.pt
17200_saved A_grid_contourf.png
[17400] loss=4.325e+09 | pde=4.269e+09 dir=5.101e+02 neu=4.634e+11
[OK] saved -> 17400_pinn_model.pt
17400_saved A_grid_contourf.png
[17600] loss=2.977e+09 | pde=2.958e+09 dir=1.344e+02 neu=6.048e+11
[OK] saved -> 17600_pinn_model.pt
17600_saved A_grid_contourf.png
[17800] loss=1.405e+09 | pde=1.393e+09 dir=1.132e+02 neu=7.624e+10
[OK] saved -> 17800_pinn_model.pt
17800_saved A_grid_contourf.png
[18000] loss=7.599e+09 | pde=7.556e+09 dir=2.741e+02 neu=1.542e+12
[OK] saved -> 18000_pinn_model.pt
18000_saved A_grid_contourf.png
[18200] loss=2.815e+09 | pde=2.801e+09 dir=1.279e+02 neu=1.693e+11
[OK] saved -> 18200_pinn_model.pt
18200_saved A_grid_contourf.png
[18400] loss=1.946e+09 | pde=1.940e+09 dir=5.211e+01 neu=3.558e+10
[OK] saved -> 18400_pinn_model.pt
18400_saved A_grid_contourf.png
[18600] loss=2.008e+09 | pde=1.998e+09 dir=5.889e+01 neu=4.481e+11
[OK] saved -> 18600_pinn_model.pt
18600_saved A_grid_contourf.png
[18800] loss=1.193e+09 | pde=1.183e+09 dir=5.178e+01 neu=4.301e+11
[OK] saved -> 18800_pinn_model.pt
18800_saved A_grid_contourf.png
[19000] loss=4.242e+09 | pde=4.218e+09 dir=2.300e+02 neu=1.266e+11
[OK] saved -> 19000_pinn_model.pt
19000_saved A_grid_contourf.png
[19200] loss=1.909e+09 | pde=1.898e+09 dir=8.076e+01 neu=2.680e+11
[OK] saved -> 19200_pinn_model.pt
19200_saved A_grid_contourf.png
[19400] loss=2.546e+09 | pde=2.535e+09 dir=6.335e+01 neu=4.813e+11
[OK] saved -> 19400_pinn_model.pt
19400_saved A_grid_contourf.png
[19600] loss=2.672e+09 | pde=2.656e+09 dir=1.112e+02 neu=4.966e+11
[OK] saved -> 19600_pinn_model.pt
19600_saved A_grid_contourf.png
[19800] loss=4.907e+09 | pde=4.886e+09 dir=1.806e+02 neu=2.678e+11
[OK] saved -> 19800_pinn_model.pt
19800_saved A_grid_contourf.png
[20000] loss=3.118e+09 | pde=3.096e+09 dir=1.962e+02 neu=2.195e+11
[OK] saved -> 20000_pinn_model.pt
20000_saved A_grid_contourf.png
実行時間： 0.31655144691467285 秒
